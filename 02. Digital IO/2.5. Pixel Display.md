# Pixel Display 
NeoPixel은 WS2812라는 칩이 내장된 RGB LED로, 하나의 데이터 선만으로 다수의 LED를 개별 제어할 수 있는 매우 효율적인 구조를 가지고 있습니다.

이 LED들은 픽셀 단위로 색상과 밝기를 조절할 수 있어, 디지털 아트, 간단한 디스플레이, 센서 시각화 등에 널리 활용됩니다.

Pixel Display 제어에 사용되는 WS2812 는 내부에 마이크로컨트롤러와 세 개의 컬러 다이오드(R, G, B) 를 포함한 지능형 LED입니다.각 LED는 24비트(8비트 × 3채널) 색상 데이터를 받으며, 데이터 신호가 직렬로 다음 LED로 전달됩니다. 3채널의 색상 데이터는 0~255 범위를 가집니다. 

데이터 전송은 매우 짧은 타이밍 간격으로 구분되며, MCU(마이크로컨트롤러)는 이를 정확히 맞춰야 합니다.
MicroPython의 neopixel 라이브러리는 이 과정을 하드웨어 레벨에서 자동으로 처리해주므로, 사용자는 간단히 (R, G, B) 값만 지정하면 됩니다.

## Pixel Display 연결 구성 

| Pin | 연결 대상 | 설명 |
|:---:|:---:|:---|
| 5V | +5V | 전원 |
| GND | GND | 접지 |
| GP16 | Data | Pixel Display Data |

![Pixel Display Connection](res/pixel%20connection.png)

## Pixel Display 기본 제어 
아래 코드는 Pixel Display 전체를 하나의 색상으로 채우거나 초기화하는 가장 기본적인 예제입니다.

```python
import neopixel
from machine import Pin

PIN = 16
WIDTH = 8
HEIGHT = 8
NUM_PIXELS = WIDTH * HEIGHT
BRIGHTNESS = 0.1

np = neopixel.NeoPixel(Pin(PIN, Pin.OUT), NUM_PIXELS)

def scale_color(r, g, b, s=BRIGHTNESS):
    return (int(r * s) & 255, int(g * s) & 255, int(b * s) & 255)

def fill(r, g, b):
    c = scale_color(r, g, b)
    for i in range(NUM_PIXELS):
        np[i] = c
    np.write()

def clear():
    fill(0, 0, 0)

def main():
    try:
        clear()
        fill(255,0,0)
        fill(0,255,0)
        fill(0,0,255)
    except KeyboardInterrupt:
        pass
    finally:
        clear()

if __name__ == "__main__":
    main()
```

>- neopixel.NeoPixel()을 이용해 LED 배열을 초기화합니다.
>- fill() 함수를 통해 모든 픽셀을 동일한 색상으로 설정합니다.
>- np.write()를 호출하면 실제 데이터가 WS2812에 전송되어 빛이 점등됩니다.
>- 프로그램은 빨강 → 초록 → 파랑 순서로 전체 색을 변경하며, 종료 시 clear()로 모든 LED를 끕니다.

## 무지개 효과 출력 
Pixel Display 의 장점은 각 LED에 다른 색을 순서대로 출력할 수 있다는 점입니다.
아래 예제는 8×8 디스플레이 전체에 무지개 효과를 만들어줍니다.

```python
import time, neopixel
from machine import Pin

PIN = 16
NUM_PIXELS = 64
np = neopixel.NeoPixel(Pin(PIN, Pin.OUT), NUM_PIXELS)

def wheel(pos):
    if pos < 85:
        return (int(pos * 3), int(255 - pos * 3), 0)
    elif pos < 170:
        pos -= 85
        return (int(255 - pos * 3), 0, int(pos * 3))
    else:
        pos -= 170
        return (0, int(pos * 3), int(255 - pos * 3))

def rainbow_cycle(wait=0.05):
    while True:
        for j in range(256):
            for i in range(NUM_PIXELS):
                np[i] = wheel((i * 256 // NUM_PIXELS + j) & 255)
            np.write()
            time.sleep(wait)

def main():
    try:
        rainbow_cycle(0.05)
    except KeyboardInterrupt:
        np.fill((0,0,0))
        np.write()

if __name__ == "__main__":
    main()
```
> - wheel() 함수는 0~255 범위의 입력 값을 연속적인 색상 변화로 매핑합니다.
> - rainbow_cycle()은 이 값을 시간에 따라 변화시키며 LED 전체의 색이 부드럽게 흐르듯 바뀌게 합니다.

## 좌표 지정 제어 

이번에는 원하는 좌표(x, y) 의 픽셀 색상을 지정하는 형태로 작성해 보겠습니다. 

```python
import neopixel
from machine import Pin

WIDTH, HEIGHT = 8, 8
PIN = 16
np = neopixel.NeoPixel(Pin(PIN, Pin.OUT), WIDTH * HEIGHT)

def pixel_index(x, y):
    return y * WIDTH + x

def set_pixel(x, y, r, g, b):
    np[pixel_index(x, y)] = (r, g, b)
    np.write()

def clear():
    np.fill((0,0,0))
    np.write()

def main():
    try:
        clear()
        set_pixel(0, 0, 255, 0, 0)
        set_pixel(7, 0, 0, 255, 0)
        set_pixel(0, 7, 0, 0, 255)
        set_pixel(7, 7, 255, 255, 0)
    except KeyboardInterrupt:
        clear()

if __name__ == "__main__":
    main()
```

> - pixel_index() 함수는 2차원 좌표를 내부 배열의 1차원 인덱스로 변환합니다.
> - 예제에서는 네 모서리에 다른 색상을 표시하여, 디스플레이의 좌표 체계를 학습할 수 있습니다.

## 숫자 출력 

이번에는 8x8 공간에 숫자 3을 출력하도록 작성하면 다음처럼 제어할 수 있습니다. 

```python
import neopixel
from machine import Pin

WIDTH, HEIGHT = 8, 8
PIN = 16
np = neopixel.NeoPixel(Pin(PIN, Pin.OUT), WIDTH * HEIGHT)


NUM_3 = [
    [0,1,1,1,0,0,0,0],
    [0,0,0,1,1,0,0,0],
    [0,0,1,1,1,0,0,0],
    [0,0,0,0,1,1,0,0],
    [0,0,0,0,1,1,0,0],
    [0,0,1,1,1,0,0,0],
    [0,0,0,1,1,0,0,0],
    [0,1,1,1,0,0,0,0]
]

def set_pixel(x, y, color):
    np[y * WIDTH + x] = color

def show_number(pattern, color=(0, 255, 0)):
    for y in range(HEIGHT):
        for x in range(WIDTH):
            if pattern[y][x]:
                set_pixel(x, y, color)
            else:
                set_pixel(x, y, (0,0,0))
    np.write()

def main():
    show_number(NUM_3, (0, 255, 100))

if __name__ == "__main__":
    main()
```
> - NUM_3은 8×8 행렬에 1과 0을 배치하여 숫자의 형태를 지정합니다.
> - show_number() 함수는 1에 해당하는 좌표만 지정된 색상으로 점등합니다.